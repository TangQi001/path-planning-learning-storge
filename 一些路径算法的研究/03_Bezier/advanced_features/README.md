# 高级特性模块

## 模块概述

本模块提供Bezier曲线路径规划的高级扩展功能，主要包括：

### 🔧 B样条扩展 (bspline_extension.py)

B样条曲线作为Bezier曲线的"升级版"，解决了Bezier曲线在长路径规划中的局限性。

#### 主要优势

1. **🎯 局部控制性**
   - 修改一个控制点只影响局部区域
   - 避免"牵一发而动全身"的问题

2. **🔗 更好的连续性**
   - 天然支持C²连续性
   - 无需手动调整连接点

3. **📏 适合长路径**
   - 单条曲线可处理多个航点
   - 避免龙格现象

4. **🔧 灵活性强**
   - 通过节点向量精确控制形状
   - 支持多种拟合策略

#### 与Bezier曲线的对比

| 特性 | Bezier曲线 | B样条曲线 |
|------|------------|-----------|
| 控制方式 | 全局影响 | 局部控制 ✓ |
| 连续性 | 需手动保证 | 天然C²连续 ✓ |
| 长路径处理 | 需分段 | 单条曲线 ✓ |
| 计算复杂度 | 简单 ✓ | 相对复杂 |
| 实时性 | 优秀 ✓ | 一般 |

#### 应用场景

**推荐使用B样条的情况：**
- 长距离路径规划（航点数 > 6）
- 需要频繁局部调整路径
- 对路径连续性要求很高
- 复杂地形跟随

**推荐使用Bezier曲线的情况：**
- 短距离路径规划（航点数 ≤ 6）
- 实时路径规划
- 计算资源受限
- 简单的点对点连接

## 使用示例

```python
from bspline_extension import BSplineCurve, demo_bspline_vs_bezier

# 创建B样条曲线
waypoints = [Point(0,0), Point(2,3), Point(4,1), Point(6,4)]
bspline = BSplineCurve(waypoints, degree=3)

# 采样路径点
path_points = bspline.sample_points(100)

# 运行对比演示
demo_bspline_vs_bezier()
```

## 技术细节

### B样条基函数计算

B样条曲线通过基函数的线性组合定义：

$$C(t) = \sum_{i=0}^{n} N_{i,p}(t) \cdot P_i$$

其中 $N_{i,p}(t)$ 是B样条基函数，通过递归公式计算：

$$N_{i,0}(t) = \begin{cases} 
1 & \text{if } u_i \leq t < u_{i+1} \\
0 & \text{otherwise}
\end{cases}$$

$$N_{i,p}(t) = \frac{t - u_i}{u_{i+p} - u_i} N_{i,p-1}(t) + \frac{u_{i+p+1} - t}{u_{i+p+1} - u_{i+1}} N_{i+1,p-1}(t)$$

### 节点向量设计

均匀节点向量用于生成标准B样条：
- 开始重复节点：$[0, 0, 0, 0, ...]$
- 内部均匀节点：$[..., 0.25, 0.5, 0.75, ...]$
- 结束重复节点：$[..., 1, 1, 1, 1]$

## 扩展方向

1. **非均匀B样条（NURBS）**
   - 支持权重控制
   - 精确表示圆锥曲线

2. **自适应节点向量**
   - 根据曲率自动调整节点分布
   - 优化计算效率

3. **约束优化**
   - 集成动力学约束
   - 多目标优化

4. **实时算法**
   - 快速求值算法
   - 增量更新方法 